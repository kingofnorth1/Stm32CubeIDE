/*
 * Switch.c
 *
 *  Created on: Aug 17, 2024
 *      Author: king
 */
#include "Switch.h"

uint16_t CCR2;
TIM_HandleTypeDef htim;

void Fan_Init(TIM_HandleTypeDef* htim2)
{
	htim = *htim2;
	HAL_TIMEx_PWMN_Start(&htim, TIM_CHANNEL_2);
}

void Fan_fast(uint16_t Fan_Pin)
{
	if (!HAL_GPIO_ReadPin(GPIOA, Fan_Pin))
	{
		HAL_Delay(100);
		while (!HAL_GPIO_ReadPin(GPIOA, Fan_Pin));
		CCR2 = __HAL_TIM_GET_COMPARE(&htim, TIM_CHANNEL_2);
		if (CCR2 >= 0)
		{
			CCR2 += 100;
			__HAL_TIM_SET_COMPARE(&htim, TIM_CHANNEL_2, CCR2);
		}
	}
}
